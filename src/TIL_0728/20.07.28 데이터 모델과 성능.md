# 20.07.28 데이터 모델과 성능

### 1. 정규화(Normalization)

> 데이터의 일관성, 최소한의 중복, 최대한의 유연성을 위한 방법
> 즉, 데이터를 분해하는 과정 → for 데이터 모델의 독립성 확보

- 이상현상(Anomaly) : 정규화를 하지않아 생기는 문제
  - 불필요한 정보가 추가되거나, 뭔가를 추가해야하는데 입력할 수 없음
- 정규화 절차
  1. 제1정규화 : primary key를 잡는 것
  2. 제2정규화 : 부분 함수 종속성 제거(분해)
  3. 제3정규화 : 이행 함수 종속성 제거(분해)
  4. BCNF(Boyce-Codd Normal Form) : 후보키 관련
  5. 제4정규화
  6. 제5정규화
- 정규화의 근거
  - 함수의 종속성(Functional Dependency)
- 정규화의 장점
  - 테이블을 분해하여, 입출력 데이터 양을 줄여서 성능을 향상시킬 수 있다!



### 2. 정규화의 문제점

> 데이터 중복을 제거해서 모델의 유연성을 높일 수 있지만,
> 조회(SELECT) 시 Join을 유발하기 때문에 CPU/Memory 많이 사용한다.

- Join의 사용

  ```Mysql
  SELECT 사원번호, 부서코드, 부서명, 이름, 전화번호, 주소
  	FROM 직원, 부서
  WHERE 직원.부서코드 = 부서.부서코드;
  ```

  - 중첩된 루프(Nested Loop)를 사용해야 한다.
  - 이러한 구조는 데이터 양이 증가하면 비교해야하는 __건수__도 증가한다.
    (이를 해결하기 위해 `인덱스`와 `옵티마이저(Optimizer)`가 있다.)
  - 조인(Join)이 부하를 유발하는 것은 분명하다.

- 반정규화(De-Normalization)

  > 조인(Join)으로 인한 성능 저하를 해결하기 위한 방법.

  - 데이터를 중복시키기 때문에 또 다른 문제점이 발생하기도 한다.
  - 입출력 단위인 Block Size를 넘어서면 또 성능이 떨어진다



### 3. 반정규화(De-Normalization)

> DB의 성능 향상을 위해, 데이터 중복을 허용하고 조인을 줄이는 DB성능 향상 방법
> 조회(SELECT) 속도를 향상시키지만, 모델의 유연성은 낮아진다.

- 반정규화를 수행하는 경우
  - 정규화로 종속성, 향상성은 향상되지만 수행 속도가 느려지는 경우
  - 다량의 범위를 자주 사용하는 경우
  - 특정 범위의 데이터만 자주 처리하는 경우
  - 요약/집계 정보가 자주 요구되는 경우
- 반정규화 절차
  1. 대상 조사 및 검토
     - 데이터의 처리 범위, 통계성 확인
  2. 다른 방법 검토
     - 클러스터링, 뷰, 인덱스 튜닝, 파티션 등
  3. 반정규화 수행
- 반정규화 기법
  - 계산된 칼럼 추가
  - 테이블 수직/수평분할
    - 파티션(Partition) 기법
      - Range Partition
      - List Partition
      - Hash Partition
      - Composition Partition
    - 파티션 테이블의 장점
      - 데이터 조회 시 액세스(Access) 범위가 줄어들어 성능 향상
      - 분할되어 있어 I/O 성능 향상
      - 독립적 백업 및 복구 가능
  - 테이블 병합
    - 슈퍼 타입 & 서브 타입



### 4. 분산 데이터베이스

> 물리적으로 떨어진 DB에 네트워크로 연결하여 단일 DB 이미지를 보여주고,
> 분산된 작업 처리를 수행하는 DB

```
# cf) 중앙 집중형 데이터베이스

  DB 시스템 구축 시 한 대의 물리적 시스템에 DBMS를 설치하고,
  여러 명의 사용자가 DBMS에 접속하여 DB를 사용하는 구조
```

- 분산 DB의 투명성
  - 분할 투명성
  - 위치 투명성
  - 지역 사상 투명성
  - 중복 투명성
  - 장애 투명성
  - 병행 투명성
- 분산 데이터베이스 설계방식
  - 상향식 설계방식
    - Local → Global
  - 하향식 설계방식
    - Global → Local
- 분산 데이터베이스 설계방식의 장점과 단점
  - 장점
    - DB의 신뢰성과 가용성이 높다
    - 병렬 처리 → 빠른 응답 가능
    - 분산 DB를 추가하면 시스템 용량 확장이 용이하다
  - 단점
    - 여러 네트웍으로 분리 → 관리와 통제가 어렵다
    - 보안관리가 어렵다
    - 데이터 무결성 관리가 어렵다
    - DB 설계가 복잡하다.